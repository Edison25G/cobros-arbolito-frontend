<div class="card shadow-md border-0 rounded-lg">
	<div class="flex items-center justify-between gap-4 mb-5 p-4 bg-gray-50 rounded-t-lg">
		<div>
			<h2 class="text-2xl font-semibold text-gray-800">Gestión de Usuarios</h2>
			<p class="text-sm text-gray-500">Administra las cuentas de acceso al sistema (Secretarios, etc.).</p>
		</div>
		<p-button (click)="crearUsuario()" label="Nuevo Usuario" icon="pi pi-plus" styleClass="p-button-success"></p-button>
	</div>

	<p-table
		[value]="usuarios"
		[loading]="isLoading"
		[paginator]="true"
		[rows]="10"
		styleClass="p-datatable-striped"
		responsiveLayout="scroll"
	>
		<ng-template pTemplate="header">
			<tr>
				<th pSortableColumn="username">Usuario <p-sortIcon field="username"></p-sortIcon></th>
				<th pSortableColumn="email">Correo Electrónico <p-sortIcon field="email"></p-sortIcon></th>
				<th pSortableColumn="role">Rol <p-sortIcon field="role"></p-sortIcon></th>
				<th pSortableColumn="activo">Estado <p-sortIcon field="activo"></p-sortIcon></th>
				<th class="text-center">Acciones</th>
			</tr>
		</ng-template>

		<ng-template pTemplate="body" let-usuario>
			<tr>
				<td>
					<span class="font-medium text-gray-700">{{ usuario.username }}</span>
				</td>
				<td>{{ usuario.email }}</td>
				<td>
					<p-tag [severity]="usuario.role === Role.Admin ? 'danger' : 'info'" [value]="usuario.role"></p-tag>
				</td>
				<td>
					<p-tag
						[severity]="usuario.activo ? 'success' : 'warn'"
						[value]="usuario.activo ? 'Activo' : 'Inactivo'"
					></p-tag>
				</td>
				<td>
					<div class="flex justify-center gap-2">
						<p-button
							pButton
							pRipple
							pTooltip="Editar usuario"
							tooltipPosition="top"
							(click)="editarUsuario(usuario)"
							icon="pi pi-pencil"
							class="p-button-rounded p-button-text p-button-warning"
						></p-button>

						<p-button
							pButton
							pRipple
							[pTooltip]="usuario.activo ? 'Desactivar usuario' : 'Activar usuario'"
							tooltipPosition="top"
							(click)="cambiarEstado(usuario)"
							[icon]="usuario.activo ? 'pi pi-times-circle' : 'pi pi-check-circle'"
							[ngClass]="usuario.activo ? 'p-button-danger' : 'p-button-success'"
							class="p-button-rounded p-button-text"
						></p-button>
					</div>
				</td>
			</tr>
		</ng-template>

		<ng-template pTemplate="emptymessage">
			<tr>
				<td colspan="5" class="text-center">No se encontraron usuarios.</td>
			</tr>
		</ng-template>
	</p-table>
</div>
