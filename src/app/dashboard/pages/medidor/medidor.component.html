<div class="flex flex-col gap-6">
	<p-card styleClass="shadow-md border-0 rounded-lg">
		<ng-template pTemplate="header">
			<div class="p-4 bg-gray-50 rounded-t-lg">
				<h2 class="text-xl font-semibold text-gray-800">Información de mi Medidor</h2>
			</div>
		</ng-template>

		<div class="p-4">
			<div *ngIf="isLoadingMedidor" class="grid grid-cols-3 gap-4">
				<p-skeleton height="2rem" styleClass="mb-2"></p-skeleton>
				<p-skeleton height="2rem" styleClass="mb-2"></p-skeleton>
				<p-skeleton height="2rem" styleClass="mb-2"></p-skeleton>
				<p-skeleton height="1rem" styleClass="mb-2"></p-skeleton>
				<p-skeleton height="1rem" styleClass="mb-2"></p-skeleton>
				<p-skeleton height="1rem" styleClass="mb-2"></p-skeleton>
			</div>

			<div *ngIf="!isLoadingMedidor && medidor" class="grid grid-cols-1 md:grid-cols-3 gap-4">
				<div>
					<span class="text-sm font-medium text-gray-500">Código de Medidor</span>
					<p class="text-lg font-semibold text-gray-800">{{ medidor.codigo }}</p>
				</div>
				<div>
					<span class="text-sm font-medium text-gray-500">Marca</span>
					<p class="text-lg font-semibold text-gray-800">{{ medidor.marca }}</p>
				</div>
				<div>
					<span class="text-sm font-medium text-gray-500">Fecha de Instalación</span>
					<p class="text-lg font-semibold text-gray-800">
						{{ medidor.fechaInstalacion | date: 'dd/MM/yyyy' }}
					</p>
				</div>
			</div>

			<div *ngIf="!isLoadingMedidor && !medidor" class="text-center text-gray-500">
				<i class="pi pi-exclamation-circle text-2xl mb-2"></i>
				<p>No tienes un medidor asignado actualmente.</p>
			</div>
		</div>
	</p-card>

	<div class="card shadow-md border-0 rounded-lg">
		<div class="flex items-center justify-between gap-4 mb-5 p-4 bg-gray-50 rounded-t-lg">
			<div>
				<h2 class="text-xl font-semibold text-gray-800">Historial de Lecturas</h2>
				<p class="text-sm text-gray-500">El historial de consumo registrado de tu medidor.</p>
			</div>
		</div>

		<p-table
			[value]="historial"
			[loading]="isLoadingHistorial"
			[paginator]="true"
			[rows]="5"
			styleClass="p-datatable-striped"
			responsiveLayout="scroll"
		>
			<ng-template pTemplate="header">
				<tr>
					<th pSortableColumn="fechaLectura">Fecha de Lectura <p-sortIcon field="fechaLectura"></p-sortIcon></th>
					<th pSortableColumn="valorLectura">Lectura (m³) <p-sortIcon field="valorLectura"></p-sortIcon></th>
					<th pSortableColumn="consumoMes">Consumo del Mes (m³) <p-sortIcon field="consumoMes"></p-sortIcon></th>
				</tr>
			</ng-template>

			<ng-template pTemplate="body" let-lectura>
				<tr>
					<td>
						<span class="font-medium">{{ lectura.fechaLectura | date: 'dd/MM/yyyy' }}</span>
					</td>
					<td>{{ lectura.valorLectura | number }} m³</td>
					<td>
						<span class="font-bold text-emerald-600">{{ lectura.consumoMes | number }} m³</span>
					</td>
				</tr>
			</ng-template>

			<ng-template pTemplate="emptymessage">
				<tr>
					<td colspan="3" class="text-center">No se encontraron lecturas en tu historial.</td>
				</tr>
			</ng-template>
		</p-table>
	</div>
</div>
