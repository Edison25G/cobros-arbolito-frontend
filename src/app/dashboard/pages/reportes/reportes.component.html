<p-toast></p-toast>

<div class="p-2 sm:p-6 animate-fade-in">
	<div class="mb-6">
		<h2 class="text-2xl font-bold text-gray-800 mb-2">Reportes y Análisis</h2>
		<p class="text-gray-500">Consulta histórica y exportación de datos.</p>
	</div>

	<p-toolbar styleClass="bg-white border-gray-200 rounded-xl shadow-sm mb-6">
		<div class="p-toolbar-group-start gap-4">
			<span class="p-float-label">
				<p-datepicker
					[(ngModel)]="rangeDates"
					selectionMode="range"
					[readonlyInput]="true"
					placeholder="Seleccionar rango..."
					[showIcon]="true"
					(onClose)="filtrarPorFechas()"
				>
				</p-datepicker>
			</span>
			<small class="text-gray-400 self-center hidden sm:block">Selecciona fechas para filtrar</small>
		</div>

		<div class="p-toolbar-group-end">
			<p-button label="Descargar PDF" icon="pi pi-file-pdf" styleClass="p-button-danger" (onClick)="descargarPDF()">
			</p-button>
		</div>
	</p-toolbar>

	<div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
		<div class="lg:col-span-1">
			<div class="bg-white p-6 rounded-xl shadow-sm border border-gray-100 h-full">
				<h3 class="font-bold text-gray-700 mb-4">Tendencia Semestral</h3>
				<p-chart type="bar" [data]="chartData" [options]="chartOptions"></p-chart>
			</div>
		</div>

		<div class="lg:col-span-2">
			<div class="bg-white rounded-xl shadow-sm border border-gray-100 overflow-hidden">
				<div class="p-4 border-b border-gray-100 bg-gray-50">
					<h3 class="font-bold text-gray-700">Detalle de Transacciones</h3>
				</div>

				<p-table
					[value]="transacciones"
					[loading]="isLoading"
					[rows]="5"
					[paginator]="true"
					styleClass="p-datatable-sm"
				>
					<ng-template pTemplate="header">
						<tr>
							<th>Fecha</th>
							<th>Socio</th>
							<th>Concepto</th>
							<th>Estado</th>
							<th class="text-right">Monto</th>
						</tr>
					</ng-template>
					<ng-template pTemplate="body" let-t>
						<tr>
							<td>{{ t.fecha }}</td>
							<td class="font-bold">{{ t.socio }}</td>
							<td>{{ t.concepto }}</td>
							<td>
								<span
									[class]="
										'px-2 py-1 rounded text-xs font-bold ' +
										(t.estado === 'Pagado'
											? 'bg-green-100 text-green-700'
											: t.estado === 'Pendiente'
												? 'bg-orange-100 text-orange-700'
												: 'bg-red-100 text-red-700')
									"
								>
									{{ t.estado }}
								</span>
							</td>
							<td class="text-right font-mono">{{ t.monto | currency }}</td>
						</tr>
					</ng-template>
				</p-table>
			</div>
		</div>
	</div>
</div>
